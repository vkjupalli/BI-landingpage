<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Words Outside Triangle Logo</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: Arial, sans-serif;
      }
      #container {
        position: relative;
        width: 100%;
        height: 100%;
        background: white;
      }
      #logo-svg {
        position: absolute;
        width: 300px;
        height: 300px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        cursor: pointer;
      }
      #logo-svg:focus {
        outline: none;
      }
      polygon#logo-triangle {
        fill: #0b63ff;
        opacity: 0.12;
        pointer-events: none;
      }
      .word {
        position: absolute;
        color: #ccc;
        opacity: 0.7;
        user-select: none;
        white-space: nowrap;
        cursor: default;
        transition: left 1s ease, top 1s ease;
      }
    </style>
  </head>
  <body>
    <div id="container" aria-label="Triangle logo with words around" role="img">
      <a
        href="https://google.com"
        target="_blank"
        rel="noopener noreferrer"
        id="logo-link"
        tabindex="-1"
        aria-hidden="true"
      >
        <img id="logo-svg" src="logo.svg" alt="Logo" />
      </a>
    </div>

    <script>
      const container = document.getElementById('container');
      const logoSVG = document.getElementById('logo-svg');
      const logoLink = document.getElementById('logo-link');

      const words = [
        'Royalties',
        'Marketing',
        'Prototyping',
        'Appraisals',
        'Confidentiality',
        'Ideas',
        'Design',
        'Rights',
        'Protect',
        'Your',
        'Idea',
        'Creative',
        'Patents',
        'Designs',
        'Licensing',
        'Practical',
        'Workshops',
        'Copy',
        'Rights',
        'Invention',
        'Crowdfunding',
        'Patent',
        'Pending',
        'Trade',
        'Secrets',
        'Branding',
        'Marks',
        'IP',
        'Innovation',
        'Business',
        'Support',
        'Patent',
        'Attorneys',
        'NDA',
        'CDA',
        'Investors',
        'Funding',
      ];

      const trianglePoints = [
        { x: 400, y: 120 },
        { x: 680, y: 680 },
        { x: 120, y: 680 },
      ];

      function pointInTriangle(pt, v1, v2, v3) {
        const dX = pt.x - v3.x;
        const dY = pt.y - v3.y;
        const dX21 = v3.x - v2.x;
        const dY12 = v2.y - v3.y;
        const D = dY12 * (v1.x - v3.x) + dX21 * (v1.y - v3.y);
        const s = dY12 * dX + dX21 * dY;
        const t = (v3.y - v1.y) * dX + (v1.x - v3.x) * dY;
        if (D < 0) return s <= 0 && t <= 0 && s + t >= D;
        return s >= 0 && t >= 0 && s + t <= D;
      }

      // Container and SVG bounding rects
      const containerRect = container.getBoundingClientRect();
      const svgRect = logoSVG.getBoundingClientRect();

      const scaleX = svgRect.width / 800;
      const scaleY = svgRect.height / 800;

      function svgToContainer(pt) {
        return {
          x: svgRect.left - containerRect.left + pt.x * scaleX,
          y: svgRect.top - containerRect.top + pt.y * scaleY,
        };
      }
      function containerToSVG(pt) {
        return {
          x: (pt.x - (svgRect.left - containerRect.left)) / scaleX,
          y: (pt.y - (svgRect.top - containerRect.top)) / scaleY,
        };
      }
      function pointInTriangleContainerCoords(pt) {
        const svgPt = containerToSVG(pt);
        return pointInTriangle(svgPt, ...trianglePoints);
      }

      const logoCenter = svgToContainer({ x: 400, y: 460 });

      function overlapsAny(box, boxes, padding = 0) {
        return boxes.some(
          (b) =>
            !(
              box.x + box.width + padding < b.x - padding ||
              box.x - padding > b.x + b.width + padding ||
              box.y + box.height + padding < b.y - padding ||
              box.y - padding > b.y + b.height + padding
            )
        );
      }

      // Polygon bounding box in container coords
      const polyMinX =
        Math.min(...trianglePoints.map((p) => p.x)) * scaleX +
        (svgRect.left - containerRect.left);
      const polyMaxX =
        Math.max(...trianglePoints.map((p) => p.x)) * scaleX +
        (svgRect.left - containerRect.left);
      const polyMinY =
        Math.min(...trianglePoints.map((p) => p.y)) * scaleY +
        (svgRect.top - containerRect.top);
      const polyMaxY =
        Math.max(...trianglePoints.map((p) => p.y)) * scaleY +
        (svgRect.top - containerRect.top);

      const polyBox = {
        x: polyMinX,
        y: polyMinY,
        width: polyMaxX - polyMinX,
        height: polyMaxY - polyMinY,
      };

      function boxesOverlap(boxA, boxB) {
        return !(
          boxA.x + boxA.width < boxB.x ||
          boxA.x > boxB.x + boxB.width ||
          boxA.y + boxA.height < boxB.y ||
          boxA.y > boxB.y + boxB.height
        );
      }

      function randInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function placeWords() {
        const oldWords = container.querySelectorAll('.word');
        oldWords.forEach((w) => w.remove());

        const placedBoxes = [];
        const padding = 10;
        const containerWidth = container.clientWidth;
        const containerHeight = container.clientHeight;

        const wordsToPlace = words.concat(words, words);

        for (const word of wordsToPlace) {
          let tries = 0;
          while (tries < 300) {
            const fontSize = randInt(16, 32);
            const rotation = randInt(-40, 40);

            const startX = logoCenter.x;
            const startY = logoCenter.y;

            const x = Math.random() * (containerWidth - padding * 2) + padding;
            const y = Math.random() * (containerHeight - padding * 2) + padding;

            // Reject if word center is inside polygon (optional, extra safe)
            if (pointInTriangleContainerCoords({ x, y })) {
              tries++;
              continue;
            }

            // Create span to measure
            const span = document.createElement('span');
            span.className = 'word';
            span.textContent = word;
            span.style.fontSize = `${fontSize}px`;
            span.style.transform = `rotate(${rotation}deg)`;
            span.style.left = `${startX}px`;
            span.style.top = `${startY}px`;
            span.style.visibility = 'hidden';
            container.appendChild(span);

            const rect = span.getBoundingClientRect();
            const box = {
              x: x,
              y: y,
              width: rect.width,
              height: rect.height,
            };

            // Reject if word box overlaps polygon bounding box
            if (boxesOverlap(box, polyBox)) {
              container.removeChild(span);
              tries++;
              continue;
            }

            if (overlapsAny(box, placedBoxes, 4)) {
              container.removeChild(span);
              tries++;
              continue;
            }

            span.style.visibility = 'visible';
            span.offsetWidth; // trigger reflow
            span.style.left = `${x}px`;
            span.style.top = `${y}px`;

            placedBoxes.push(box);
            break;
          }
        }
      }

      placeWords();

      // Disable default link navigation on click in SVG
      logoLink.addEventListener('click', (e) => {
        e.preventDefault();
        const rect = container.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const clickY = e.clientY - rect.top;

        if (pointInTriangleContainerCoords({ x: clickX, y: clickY })) {
          window.open('https://google.com', '_blank');
        } else {
          placeWords();
        }
      });

      // Click outside SVG but inside container reshuffles words
      container.addEventListener('click', (e) => {
        if (!logoSVG.contains(e.target)) {
          placeWords();
        }
      });
    </script>
  </body>
</html>
